<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="css/style.css">
  <!-- Load Leaflet from CDN -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
    integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
    crossorigin="" />
  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
    integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
    crossorigin=""></script>
  <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/js/all.min.js"></script> -->
  <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
  <script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>



  <title>GeoForm Sitelok Abang</title>
  <script>

    function updateDay() {
      var currentDate = new Date();
      var dayOfWeek = getDayOfWeek(currentDate.getDay());

      document.getElementById("dayInput").value = dayOfWeek;
    }

    function getDayOfWeek(dayIndex) {
      var days = ["Hari Minggu", "Hari Senin", "Hari Selasa", "Hari Rabu", "Hari Kamis", "Hari Jumat", "Hari Sabtu"];
      return days[dayIndex];
    }

    // Panggil fungsi updateDay setiap 1 detik
    setInterval(updateDay, 1000);

    function updateDate() {
      var currentDate = new Date();
      var year = currentDate.getFullYear();
      var month = (currentDate.getMonth() + 1).toString().padStart(2, '0');
      var day = currentDate.getDate().toString().padStart(2, '0');

      var dateString = day + "-" + month + "-" + year;
      document.getElementById("dateInput").value = dateString;
    }

    // Panggil fungsi updateDate setiap 1 detik
    setInterval(updateDate, 1000);

    function updateTime() {
      var currentTime = new Date();
      var hours = currentTime.getHours().toString().padStart(2, '0');
      var minutes = currentTime.getMinutes().toString().padStart(2, '0');
      var seconds = currentTime.getSeconds().toString().padStart(2, '0');

      var timeString = hours + ":" + minutes + ":" + seconds;
      document.getElementById("timeInput").value = timeString;
    }

    // Panggil fungsi updateTime setiap 1 detik
    setInterval(updateTime, 1000);



    var map;
    var marker;
    var circle;
    var accuracyControl;

    function getLocation() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(showPosition);
      } else {
        alert("Geolocation is not supported by this browser.");
      }
    }

    function showPosition(position) {
      document.getElementById("Latitude").value = position.coords.latitude;
      document.getElementById("Longitude").value = position.coords.longitude;

      // Show the map element
      document.getElementById("map").style.display = "block";

      // Check if the map object has already been created
      if (!map) {
        // Create a map object and center it on the user's location
        map = L.map('map').setView([position.coords.latitude, position.coords.longitude], 18);

        // Add a tile layer to the map
        L.tileLayer('http://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}', {
          maxZoom: 22,
          subdomains: ['mt0', 'mt1', 'mt2', 'mt3']
        }).addTo(map);

        // Create a control to display the accuracy value
        accuracyControl = L.control({ position: 'topright' });
        accuracyControl.onAdd = function (map) {
          this._div = L.DomUtil.create('div', 'accuracy-control');
          this.update();
          return this._div;
        };
        accuracyControl.update = function (accuracy) {
          this._div.innerHTML = accuracy ? "Accuracy: " + accuracy + " meters" : "";
        };
        accuracyControl.addTo(map);
      } else {
        // Update the map center
        map.setView([position.coords.latitude, position.coords.longitude], 18);
      }
      // Update the accuracy control text
      accuracyControl.update(position.coords.accuracy);

      // Check if the marker object has already been created
      if (!marker) {
        // Add a marker to the map at the user's location
        marker = L.marker([position.coords.latitude, position.coords.longitude]).addTo(map);
      } else {
        // Update the marker position
        marker.setLatLng([position.coords.latitude, position.coords.longitude]);
      }
      // Check if the circle object has already been created
      if (!circle) {
        // Add a circle to the map representing the geolocation accuracy
        circle = L.circle([position.coords.latitude, position.coords.longitude], {
          color: '#3798f0',
          fillColor: '#85bef2',
          fillOpacity: 0.5,
          radius: position.coords.accuracy
        }).addTo(map);
      } else {
        // Update the circle position and radius
        circle.setLatLng([position.coords.latitude, position.coords.longitude]);
        circle.setRadius(position.coords.accuracy);
      }
    }

    function showStasiunOptions() {
      var modaSelected = document.getElementById("Moda").value;
      var stasiunContainer = document.getElementById("stasiunContainer");
      var stasiunDropdown = document.getElementById("Stasiun");

      // Jika moda yang dipilih adalah "LRT", tampilkan dropdown stasiun
      if (modaSelected === "LRT") {
        stasiunContainer.style.display = "block";
        // Anda dapat menambahkan kode di sini untuk memuat pilihan stasiun dari sumber data yang sesuai
      } else {
        stasiunContainer.style.display = "none";
        // Reset nilai dropdown stasiun jika moda yang dipilih bukan "LRT"
        stasiunDropdown.value = "";
      }
    }


    // Fungsi untuk menampilkan pop-up setelah formulir dikirim
    function showThankYouPopup() {
      alert("Terima kasih! Formulir telah berhasil dikirim.");
      // Anda juga bisa mengganti 'alert' dengan kode lain untuk menampilkan pop-up yang lebih menarik, seperti menggunakan modal.
      // Contoh: tampilkan modal Bootstrap, SweetAlert, atau library lainnya.
    }

    // Event listener untuk mendeteksi saat formulir dikirim
    document.querySelector("form").addEventListener("submit", function (event) {
      event.preventDefault(); // Mencegah pengiriman default formulir
      // Lakukan pengiriman data formulir ke Google Sheets atau tempat penyimpanan lainnya di sini
      // ...

      // Setelah formulir berhasil dikirim, tampilkan pop-up terima kasih
      showThankYouPopup();
    });

  </script>
</head>

<body>
  <form
    action="https://script.google.com/macros/s/AKfycbxKfHoxOWgJdSUym4ILjpSzZKzsC5ZUcXHSs38A0-3Biaien0YqjEWQqRPtUBfDd_1IjA/exec"
    method="post">
    <div class="box">
      <div class="logo">
        <img src="https://upload.wikimedia.org/wikipedia/commons/c/c5/Palembang_CoA.svg" alt="Logo Palembang"
          style="width: 40px; height: 50px;">
      </div><br>
      <p style="text-align: left; margin-left: 4%;color: #000000; font-size: small;"><b>FORM PENGGUNA -
          SiTELOK ABANG</b><br>(Sistem Informasi Transportasi Berkelanjutan Kota Palembang)</p>
      <br><br>
    </div>
    <div class="entry-section">
      <!-- <label for="No_ID">No. ID :</label> -->
      <div class="input-icon" style="position: absolute; right:35px; font-size:1.8em; line-height:45px; color: #073c7c;">
        <iconify-icon icon="ion:id-card-sharp"></iconify-icon>
      </div>
      <input name="No_ID" type="text" placeholder="No. ID (Bila diperlukan) "><br>
      <!-- <label for="Email">Email :</label> -->
      <div class="input-icon" style="position: absolute; right:40px; font-size:1.8em; line-height:40px; color: #073c7c;">
        <i class="ion-ios-email"></i>
      </div>
      <input name="Email" type="email" placeholder="Email (bila diperlukan)"><br>
      <!-- <label for="Name">Nama :</label> -->
      <div class="input-icon" style="position: absolute; right:40px; font-size:1.8em; line-height:40px; color: #073c7c;">
        <i class="ion-icon ion-person"></i>
      </div>
      <input name="Name" type="text" placeholder="Nama Anda" required><br>
      <!-- <label for="Workplace">Tempat Kerja :</label> -->
      <div class="input-icon" style="position: absolute; right:40px; font-size:1.8em; line-height:40px; color: #073c7c;">
        <i class="ion-ios-briefcase"></i>
      </div>
      <input name="Workplace" type="text" placeholder="Tempat Kerja (bila diperlukan)"><br>
      <!-- Dropdown untuk memilih perjalanan -->
      <label for="Moda">Moda Yang Digunakan</label>
      <div class="input-icon" style="position: absolute; right:55px; font-size:1.8em; line-height:45px; color: #073c7c;">
        <iconify-icon icon="ion:bus"></iconify-icon>
      </div>
      <select id="Moda" name="Moda" required onchange="showStasiunOptions()">
        <option value="none">Pilih salah satu</option>
        <option value="LRT">LRT</option>
        <option value="Transmusi/Teman Bus">Transmusi/Teman Bus</option>
        <option value="Feeder">Feeder</option>
        <option value="Angkot">Angkot</option>
        <option value="Sepeda">Sepeda</option>
        <option value="Berjalan Kaki">Berjalan Kaki</option>
      </select><br>

      <div id="stasiunContainer" style="display: none;">
        <label for="Stasiun">Pilih Stasiun:</label>
        <select id="Stasiun" name="Stasiun">
          <option value=""></option>
          <option value="Stasiun Bandara SMB II">Stasiun Bandara SMB II</option>
          <option value="Stasiun Asrama Haji">Stasiun Asrama Haji</option>
          <option value="Stasiun Punti Kayu">Stasiun Punti Kayu</option>
          <option value="Stasiun RSUD">Stasiun RSUD</option>
          <option value="Stasiun Garuda Dempo">Stasiun Garuda Dempo</option>
          <option value="Stasiun Demang Lebar Daun">Stasiun Demang Lebar Daun</option>
          <option value="Stasiun Bumi Sriwijaya">Stasiun Bumi Sriwijaya</option>
          <option value="Stasiun Dishub Sumsel">Stasiun Dishub Sumsel</option>
          <option value="Stasiun Cinde">Stasiun Cinde</option>
          <option value="Stasiun Ampera">Stasiun Ampera</option>
          <option value="Stasiun Polresta">Stasiun Polresta</option>
          <option value="Stasiun Jakabaring">Stasiun Jakabaring</option>
          <option value="Stasiun DJKA">Stasiun DJKA</option>
        </select><br>
      </div>

      <!-- Dropdown untuk memilih perjalanan -->
      <label for="Perjalanan">Tujuan Perjalanan:</label>
      <div class="input-icon" style="position: absolute; right:55px; font-size:1.8em; line-height:45px; color: #073c7c;">
        <iconify-icon icon="ion:walk-sharp"></iconify-icon>
      </div>
      <select id="Perjalanan" name="Perjalanan" required>
        <option value="">Pilih salah satu</option>
        <option value="Bekerja">Bekerja</option>
        <option value="Belanja">Belanja</option>
        <option value="Pulang">Pulang</option>
        <option value="Sekolah">Sekolah</option>
        <option value="Kuliah">Kuliah</option>
        <option value="Lainnya">Lainnya</option>
      </select><br>
      <!-- Radio button untuk memilih Naik atau Turun -->
      <label for="keterangan">Keterangan (<i>Pilih salah satu</i>)</label>
      <div class="radio-group">
        <label>
          <input type="radio" id="naik" name="keterangan" value="Naik" required>
          Naik
        </label>
        <label>
          <input type="radio" id="turun" name="keterangan" value="Turun" required>
          Turun
        </label>
      </div><br>
    </div>


    <div class="waktu-section">
      <!-- <label for="nama">Informasi Waktu </label> -->
      <input type="waktu" name="day" id="dayInput" readonly>
      <input type="waktu" name="date" id="dateInput" readonly>
      <input type="waktu" name="time" id="timeInput" readonly>
    </div>


    <div class="location-section">
      <div id="map"></div>
      <!-- <label for="Latitude">Latitude :</label> -->
      <input type="text" id="Latitude" name="Latitude" placeholder="Latitude" readonly><br>
      <!-- <label for="Longitude">Longitude :</label> -->
      <input type="text" id="Longitude" name="Longitude" placeholder="Longitude" readonly><br>
      <button type="button" onclick="getLocation()">Dapatkan Lokasi</button>
    </div>

    <div class="opini">
      <!-- Kolom Kritik/Saran -->
      <label for="kritik_saran">Kritik/Saran:</label>
      <textarea id="kritik_saran" name="kritik_saran" rows="4" cols="50" placeholder="Bila ada"></textarea><br>
      <!-- Kolom Testimoni -->
      <label for="testimoni">Testimoni:</label>
      <textarea id="testimoni" name="testimoni" rows="4" cols="50" placeholder="Bila ada"></textarea><br>
    </div>

    <button type="submit">Krim</button>
  </form>
</body>
<h4
  style="text-align: center; font-weight: 800;margin-bottom: 2px;color: #ffffff; -webkit-text-stroke: 0.75px #000000; text-shadow: 10px #007bff;">
  Copyright Â© 2022<br>BAPPEDA LITBANG KOTA PALEMBANG</h4>

</html>